---
title: "Load Data"
author: "Me"
date: "14 de febrero de 2019"
output:
  word_document:
    toc: yes
    toc_depth: '3'
  pdf_document:
    number_sections: yes
    toc: yes
    toc_depth: '3'
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 3
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading packages

```{r, include=FALSE}
# Load Required Packages: to be increased over the course
library(car)  # Manual way, use for Boxplot()

requiredPackages <- c("car","knitr","ggplot2")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]

if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)
```

## Load sample of 5000 records

```{r}
rm(list=ls())
# Load Required Packages: to be increased over the course

#setwd("d:/Users/Usuari/Documents/ADEI/bank-additional")
setwd("d:/Users/Usuari/Documents/ADEI/bank-additional")
file_path <- "d:/Users/Usuari/Documents/ADEI/bank-additional/"
load(paste0(file_path,"Bank5000_raw.RData"))
summary(df)
```

#Control d'errors, missings i outliers
```{r}
columnes <- names(df)

errors <- data.frame(matrix(0, ncol = length(columnes), nrow = 1))
colnames(errors)<-columnes
errors

missigns <- data.frame(matrix(0, ncol = length(columnes), nrow = 1))
colnames(missigns)<-columnes
missigns

outliers <- data.frame(matrix(0, ncol = length(columnes), nrow = 1))
colnames(outliers)<-columnes
outliers
```



#Univariate Descriptive Analysis and Data Quality Report
##Qualitative Variables

En aquesta secció convertiren les variables corresponents a conceptes qualitatius en factors.

###Job
```{r}
summary(df$job)
df$job<-factor(df$job)

num_missings<-which(df$job == "unknown")
missigns$job=length(num_missings)

levels(df$job)<-paste0("Job-",levels(df$job))
summary(df$job)

barplot(summary(df$job), main = "Barplot Job", col = "orange")
```


###Marital
```{r}
summary(df$marital)
df$marital<-factor(df$marital)

num_missings<-which(df$marital == "unknown")
missigns$marital=length(num_missings)

levels(df$marital)<-paste0("Marital-",levels(df$marital))
summary(df$marital)

barplot(summary(df$marital), main = "Barplot Marital", col = "orange")
```


###Education
```{r}
summary(df$education)
df$education<-factor(df$education)

num_missings<-which(df$education == "unknown")
missigns$education=length(num_missings)

levels(df$education)<-paste0("Education-",levels(df$education))
summary(df$education)

barplot(summary(df$education), main = "Barplot Education", col = "orange")
```

###Default
```{r}
summary(df$default)
df$default<-factor(df$default)

num_missings<-which(df$default == "unknown")
missigns$default=length(num_missings)

levels(df$default)<-paste0("Default-",levels(df$default))
summary(df$default)

barplot(summary(df$default), main = "Barplot Default", col = "orange")
```


###Housing
```{r}
summary(df$housing)
df$housing<-factor(df$housing)

num_missings<-which(df$housing == "unknown")
missigns$housing=length(num_missings)

levels(df$housing)<-paste0("Housing-",levels(df$housing))
summary(df$housing)

barplot(summary(df$housing), main = "Barplot Housing", col = "orange")
```

###Loan
```{r}
summary(df$loan)
df$loan<-factor(df$loan)

num_missings<-which(df$loan == "unknown")
missigns$loan=length(num_missings)

levels(df$loan)<-paste0("Loan-",levels(df$loan))
summary(df$loan)

barplot(summary(df$loan), main = "Barplot Loan", col = "orange")
```

###Contact
```{r}
summary(df$contact)
df$contact<-factor(df$contact)

num_missings<-which(df$contact == "unknown")
missigns$contact=length(num_missings)

levels(df$contact)<-paste0("Contact-",levels(df$contact))
summary(df$contact)

barplot(summary(df$contact), main = "Barplot Contact", col = "orange")
```

###Month
```{r}
summary(df$month)
df$month<-factor(df$month)

num_missings<-which(df$month == "unknown")
missigns$month=length(num_missings)

levels(df$month)<-paste0("Month-",levels(df$month))
summary(df$month)

barplot(summary(df$month), main = "Barplot Month", col = "orange")
```

###Day_of_week
```{r}
summary(df$day_of_week)
df$day_of_week<-factor(df$day_of_week)

num_missings<-which(df$day_of_week == "unknown")
missigns$day_of_week=length(num_missings)

levels(df$day_of_week)<-paste0("Day_of_week-",levels(df$day_of_week))
summary(df$day_of_week)

barplot(summary(df$day_of_week), main = "Barplot Day_of_week", col = "orange")
```

###Poutcome
```{r}
summary(df$poutcome)
df$poutcome<-factor(df$poutcome)

num_missings<-which(df$poutcome == "nonexistent")
missigns$poutcome=length(num_missings)

levels(df$poutcome)<-paste0("Poutcome-",levels(df$poutcome))
summary(df$poutcome)

barplot(summary(df$poutcome), main = "Barplot Poutcome", col = "orange")
```

###y
```{r}
summary(df$y)
df$y<-factor(df$y)

num_missings<-which(df$y == "unknown")
missigns$y=length(num_missings)

levels(df$y)<-paste0("Subscribed-",levels(df$y))
summary(df$y)

barplot(summary(df$y), main = "Barplot Subscribed (y)", col = "orange")
```


##Quantitative Variables


###Ouliers function
```{r}

calcQ <- function(x) {
  s.x <- summary(x)
  iqr<-s.x[5]-s.x[2]
  list(souti=s.x[2]-3*iqr, mouti=s.x[2]-1.5*iqr, min=s.x[1], q1=s.x[2], q2=s.x[3], 
       q3=s.x[5], max=s.x[6], mouts=s.x[5]+1.5*iqr, souts=s.x[5]+3*iqr ) }

```


###Age
```{r}
summary(df$age)
hist(df$age,20,main = "Histogram Age", col = "orange")
Boxplot(df$age)

num_missings<-which(is.na(df$age))
missings$age=length(num_missings)

outValues<-calcQ(df$age)
abline(h=outValues$mouts,col="red",lwd=2)

#no tenim outliers extrems?

out<-which(df$age >= outValues$souts)
outliers$age=length(out)


df[out,"age"]<-NA

summary(df$age)

```

###Duration
```{r}
summary(df$duration)
hist(df$duration,20,main = "Histogram Duration", col = "orange")
Boxplot(df$duration)


num_missings<-which(is.na(df$duration))
missings$duration=length(num_missings)

outValues<-calcQ(df$duration)
abline(h=outValues$souts,col="red",lwd=2)

out<-which(df$duration >= outValues$souts)

outliers$duration=length(out)

df[out,"duration"]<-NA

summary(df$duration)
Boxplot(df$duration)
```

###Campaign
```{r}
summary(df$campaign)
hist(df$campaign,20,main = "Histogram Campaign", col = "orange")
Boxplot(df$campaign)


num_missings<-which(is.na(df$campaign))
missings$campaign=length(num_missings)

outValues<-calcQ(df$campaign)
abline(h=outValues$souts,col="red",lwd=2)

out<-which(df$campaign >= outValues$souts)
outliers$campaign=length(out)

df[out,"campaign"]<-NA

summary(df$campaign)
Boxplot(df$campaign)
```


###Pdays
```{r}
summary(df$pdays)
hist(df$pdays,20,main = "Histogram Pdays", col = "orange")
Boxplot(df$pdays)

num_missings<-which(df$pdays==999)

num_missings<-which(is.na(df$pdays))
missings$pdays=length(num_missings)

outValues<-calcQ(df$pdays)
abline(h=outValues$souts,col="red",lwd=2)

out<-which(df$pdays >= outValues$souts)
outliers$pdays=length(out)

df[out,"pdays"]<-NA

summary(df$pdays)
Boxplot(df$pdays)
```


###Previous (Tots NA)
```{r}
summary(df$previous)
hist(df$previous,20,main = "Histogram Previous", col = "orange")
Boxplot(df$previous)

num_missings<-which(is.na(df$previous))
missings$previous=length(num_missings)

outValues<-calcQ(df$previous)
abline(h=outValues$souts,col="red",lwd=2)

out<-which(df$previous >= outValues$souts)
outliers$previous=length(out)

df[out,"previous"]<-NA

summary(df$previous)
Boxplot(df$previous)
```


###Emp.var.rate
```{r}
summary(df$emp.var.rate)
hist(df$emp.var.rate,20,main = "Histogram Emp.var.rate", col = "orange")
Boxplot(df$emp.var.rate)

outValues<-calcQ(df$emp.var.rate)
abline(h=outValues$souts,col="red",lwd=2)


#no tenim outliers extrems?

out<-which(df$emp.var.rate >= outValues$souts)
outliers$emp.var.rate=length(out)

df[out,"emp.var.rate"]<-NA

summary(df$emp.var.rate)
Boxplot(df$emp.var.rate)

```


###Cons.price.idx
```{r}
summary(df$cons.price.idx)
hist(df$cons.price.idx,20,main = "Histogram Cons.price.idx", col = "orange")
Boxplot(df$cons.price.idx)

outValues<-calcQ(df$cons.price.idx)
abline(h=outValues$souts,col="red",lwd=2)


#no tenim outliers extrems?

out<-which(df$cons.price.idx >= outValues$souts)
outliers$cons.price.idx=length(out)


df[out,"cons.price.idx"]<-NA

summary(df$cons.price.idx)
Boxplot(df$cons.price.idx)
```


###cons.conf.idx
```{r}
summary(df$cons.conf.idx)
hist(df$cons.conf.idx,20,main = "Histogram Cons.conf.idx", col = "orange")
Boxplot(df$cons.conf.idx)

outValues<-calcQ(df$cons.conf.idx)
abline(h=outValues$souts,col="red",lwd=2)


#no tenim outliers extrems?

out<-which(df$cons.conf.idx >= outValues$souts)
outliers$cons.conf.idx=length(out)

df[out,"cons.conf.idx"]<-NA

summary(df$cons.conf.idx)
Boxplot(df$cons.conf.idx)
```

###Euribor3m
```{r}
summary(df$euribor3m)
hist(df$euribor3m,20,main = "Histogram Euribor3m", col = "orange")
Boxplot(df$euribor3m)

outValues<-calcQ(df$euribor3m)
abline(h=outValues$souts,col="red",lwd=2)


#no tenim outliers extrems?

out<-which(df$euribor3m >= outValues$souts)
outliers$euribor3m=length(out)

df[out,"euribor3m"]<-NA

summary(df$euribor3m)
Boxplot(df$euribor3m)
```

###Nr.employed
```{r}
summary(df$nr.employed)
hist(df$nr.employed,20,main = "Histogram Nr.employed", col = "orange")
Boxplot(df$nr.employed)

outValues<-calcQ(df$nr.employed)
abline(h=outValues$souts,col="red",lwd=2)


#no tenim outliers extrems?

out<-which(df$nr.employed >= outValues$souts)
outliers$nr.employed=length(out)

df[out,"nr.employed"]<-NA

summary(df$nr.employed)
Boxplot(df$nr.employed)
```


#Emmagatzematge de les dades
```{r}
save.image("d:/Users/Usuari/Documents/ADEI/bank-additional/Univ_Desc_Anal.RData")
```








