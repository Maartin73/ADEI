---
title: "European Temperatures"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(FactoMineR)

temperature<-read.table("http://factominer.free.fr/book/temperature.csv", header=TRUE, sep=";", dec=".", row.names=1);temperature
#Categoria "Amplitud": diferencies termiques entre minim i maxim de les temperatures
summary(temperature)


#PCA:

#categories (variables) quantitatives suplementaries: Annual, Latitude, Longitude, Amplitude.
resPCA<-PCA(temperature[,1:16], quanti.sup=13:16) 

# Only capitals of countries are the active rows (1:23), les altres (24:35) seran individus suplementaris i no s'usaran en el còmput del PCA. Les categories (variables) quantitatives suplementaries son 13:16, categoria qualitativa suplementaria es 17 (area en lila al plot).
resPCA<-PCA(temperature, ind.sup=24:35, quanti.sup=13:16 , quali.sup=17) 
# Gràfic 1: mapa de factors dels individus!

# Gràfic 2: mapa de variables de les variables (projectades)!: entre amplitud i latitud no hi ha correlació (ortogonals), entre longitud i amplitud es pot veure que com hi ha una correlació (angles petits) entre la longitud (est/oest) i la diferencia de temperatures max i min. També es pot veure com la latitud (nord/sud) está correlada negativament amb les altes temperatures (June-April)!
#----> Clima continental (est d'Europa): gran amplitud termica -> a mes longitud (est), mes amplitud termica!
#----> Clima Reykjavik (oest): molt fred pero poca amplitud termica (temp constants) -> a menys longitud (oest), menys amplitud termica.


summary(resPCA, nb.dec=2, ncp=4, nbelements=12)
#es pot veure com de 12 columnes, un 98% de la informació es podria resumir amb 2 dimensions! (eixos vists als gràfics PCA).
#teorema Kaiser' diu que s'han d'agafar les dimensions que estan només per sobre la unitat de variancia (en aquest cas la dimensio 1 i 2). 


# Individuals (the 12 first)
#                    Dist   Dim.1   ctr  cos2     
# Amsterdam       |  1.44 |  0.23  0.02  0.02
# Athens          |  7.68 |  7.60 25.25  0.98
# Berlin          |  0.50 | -0.29  0.04  0.33
# Brussels        |  1.36 |  0.63  0.17  0.22
#----> La columna Dim.1/2/etc. son les noves coordenades (projeccció) al(s) nou(s) eix(os) i és el que s'anomena/en component(s) principal(s).
#----> La columna "ctr" es la contribucio (importancia) que te cada individu actiu (capital) en la seleccio del nou eix. Si es sumen totes dona un 100%.
#----> La columna "cos2" (cosinus quadrat) ens diu la qualitat de la representacio de l'individu en el nou eix factorial (proximitat de la representació en l'eix). Exemple de London: té un cos2 de 0.98 en la 2a dimensio (eix y) i està just sobre l'eix; té un cos2 de 0.00 en la 1 dimensio, esta en la mitjana, no ens diu res gaire representatiu.


# Variables
#                   Dim.1   ctr  cos2   Dim.2   ctr  cos2   Dim.3   ctr  cos2   Dim.4   ctr  cos2  
# January         |  0.84  7.13  0.71 | -0.53 15.28  0.28 |  0.07  3.64  0.00 |  0.01  0.36  0.00 |
# February        |  0.88  7.86  0.78 | -0.46 11.25  0.21 |  0.00  0.01  0.00 |  0.08 18.30  0.01 |
# March           |  0.95  8.98  0.89 | -0.29  4.47  0.08 | -0.12 11.56  0.01 |  0.08 15.81  0.01 |
# April           |  0.97  9.53  0.95 |  0.10  0.54  0.01 | -0.20 31.13  0.04 |  0.02  1.61  0.00 |
#-----> Amb les variables, al estar normalitzat, el valor de la coordenada (Dim.1/2/etc) es exactament la correlacio de la variable original amb l'eix factorial en questio.


# Supplementary categories
#                    Dist   Dim.1  cos2 v.test   Dim.2  cos2 v.test
# East            |  1.78 | -1.10  0.38  -1.08 |  1.38  0.60   3.15
# North           |  2.65 | -2.44  0.85  -2.40 | -0.99  0.14  -2.26
# South           |  4.57 |  4.56  1.00   3.58 |  0.14  0.00   0.25
# West            |  1.03 |  0.50  0.23   0.34 | -0.86  0.69  -1.36
#----> En el valor "South" veiem que el grup d'individus d'aquesta categoria esta lleugerament destacat a la resta en la dimensió corresponent. A més, un valor absolut de v.test més gran que 3 ens indica clarament que aquests individus estan destacats de la resta.


# Atributs PCA:
attributes(resPCA)

resPCA$ind$coord #veure nomes coordenades
resPCA$ind$coord[,1:2] #veure nomes coordenades dim1-2

resPCA$ind$contrib[,1:2] #veure nomes contribucions
sum(resPCA$ind$contrib[,1]) #sumen 100

resPCA$eig #eigenvalues
sum(resPCA$eig[,1]) #dona 12, que es igual al nombre de dimensions

```

